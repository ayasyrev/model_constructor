<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

# model_constructor

> Constructor to create pytorch model.


_

## Install

`pip install model-constructor`

## How to use

model = Net()
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
model = Net()
```

</div>

</div>

# Resnet as example

But it can be created as:

Lets create resnet18 and resnet34 (default Net() is resnet34()).
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
resnet18 = Net(block=BasicBlock, blocks=[2, 2, 2, 2])
```

</div>

</div>
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
resnet34 = Net(block=BasicBlock, blocks=[3, 4, 6, 3])
```

</div>

</div>

Predefined Resnet18 and Resnet34.
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
from model_constructor.resnet import *
```

</div>

</div>
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
model = resnet34(num_classes=10)
```

</div>

</div>

# Some examples

We can experiment with models by changing some parts of model. Here only base functionality, but it can be easily extanded.

Here some examples:
    

## Custom stem

Stem with 3 conv layers
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
model = Net(stem=partial(Stem, sizes=[32, 32]))
```

</div>

</div>
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
model.stem
```

</div>
<div class="output_area" markdown="1">




    Stem(
      sizes: [3, 32, 32, 64]
      (conv0): ConvLayer(
        (conv): Conv2d(3, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
        (act_fn): ReLU(inplace=True)
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (conv1): ConvLayer(
        (conv): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (act_fn): ReLU(inplace=True)
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (conv2): ConvLayer(
        (conv): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (act_fn): ReLU(inplace=True)
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (pool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    )



</div>

</div>

## Activation function before Normalization
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
model = Net(bn_1st=False)
```

</div>

</div>
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
model.stem
```

</div>
<div class="output_area" markdown="1">




    Stem(
      sizes: [3, 64]
      (conv0): ConvLayer(
        (conv): Conv2d(3, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
        (act_fn): LeakyReLU(negative_slope=0.01, inplace=True)
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (pool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    )



</div>

</div>


## Change activation function
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
act_fn = nn.LeakyReLU(inplace=True)
```

</div>

</div>
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
model = Net(act_fn=act_fn)
```

</div>

</div>
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
model.stem
```

</div>
<div class="output_area" markdown="1">




    Stem(
      sizes: [3, 64]
      (conv0): ConvLayer(
        (conv): Conv2d(3, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
        (act_fn): LeakyReLU(negative_slope=0.01, inplace=True)
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (pool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    )



</div>

</div>
<div class="codecell" markdown="1">
<div class="input_area" markdown="1">

```python
model.body.layer_0.block_0.conv.conv_0
```

</div>
<div class="output_area" markdown="1">




    ConvLayer(
      (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (act_fn): LeakyReLU(negative_slope=0.01, inplace=True)
      (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )



</div>

</div>
